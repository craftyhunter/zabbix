# ss-zabbix
Zabbix in docker

В этом репозитории описана saltstack конфигурация zabbix сервера и его компонентов, запускаемых в docker контейнерах. Конфигурация запускалась и тестировалась в ВМ с Ubuntu 22.04.
Используются:
 - postgresql 16.1
 - zabbix-server 6.4
 - zabbix-web-server 6.4

Порядок развертывания:
1. Перейти в директорию `/srv`
2. Склонировать этот репозиторий
3. Запустить `env_prepare.sh` - скрипт установит `salt-minion` и настроит его в `masterless` режим. Создаст симлинк для salt директории.
4. Перейти в директорию `/srv/salt`
5. Запустить `salt-call --local state.apply docker` - установит docker
6. Запустить `salt-call --local state.apply zabbix.server` - создаст systemd сервисы, которые будут запускать docker контейнеры, и запустит их. А также установит zabbig-agent.


Возможные проблемы:
 - systemd-сервисы не показывают актуальное состояние контейнеров, а лишь запускают их при старте системы. Возможно это место стоит улучшить.
 - при подстановке ip адресов используется первый элемент из списка. Возможно это место стоит улучшить
 - пароль базы данных хранится в описании systemd-сервиса, безопаснее его хранить в файле и при старте сервисов читать из файла.